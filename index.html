<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuaca Realistis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            color: #fff;
            overflow: hidden; /* Mencegah scrollbar karena video */
        }
        
        /* --- BARU: Style untuk Video Background --- */
        #bg-video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: -1;
            transition: opacity 1.5s ease-in-out;
            object-fit: cover; /* Memastikan video menutupi seluruh layar */
        }
        
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Overlay sedikit lebih gelap */
            z-index: 1;
        }

        .search-box, .weather-card, #sub-locations-container {
            position: relative;
            z-index: 2;
        }

        .search-box {
            display: flex;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-radius: 50px;
        }
        .search-box input {
            border: none;
            padding: 15px 25px;
            font-size: 16px;
            border-radius: 50px 0 0 50px;
            outline: none;
            width: 280px;
            font-family: 'Poppins', sans-serif;
            color: #333;
        }
        .search-box button {
            border: none;
            background: #5a9ee4;
            color: white;
            padding: 15px 25px;
            font-size: 16px;
            border-radius: 0 50px 50px 0;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .search-box button:hover {
            background: #3c8ce7;
        }
        
        .weather-card {
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            width: 350px;
            transition: all 0.5s ease;
            opacity: 0;
            transform: translateY(20px);
        }

        .weather-card.loaded {
            opacity: 1;
            transform: translateY(0);
        }

        .location-main { font-size: 28px; font-weight: 500; margin: 0; }
        .location-sub { font-size: 16px; font-weight: 300; margin-top: 5px; opacity: 0.9; }
        .condition { display: flex; align-items: center; justify-content: center; margin-top: 10px; }
        .condition-icon { width: 80px; height: 80px; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2)); }
        .condition-text { font-size: 20px; font-weight: 400; margin-left: 10px; text-transform: capitalize; }
        .temperature { font-size: 84px; font-weight: 700; margin: 15px 0; }
        .details { display: flex; justify-content: space-around; margin-top: 20px; font-size: 15px; }
        .detail-item .label { font-weight: 300; display: block; }
        .detail-item .value { font-weight: 500; }

        /* --- BARU: Style untuk Kontainer Kecamatan --- */
        #sub-locations-container {
            margin-top: 20px;
            width: 380px;
            max-height: 150px; /* Batasi tinggi agar bisa di-scroll */
            overflow-y: auto;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .sub-location-item {
            background: rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 8px 12px;
            font-size: 14px;
            text-align: center;
            transition: background 0.3s;
        }
        .sub-location-item:hover {
             background: rgba(90, 158, 228, 0.5);
        }
    </style>
</head>
<body>
    <video autoplay muted loop id="bg-video">
        </video>
    <div class="overlay"></div>
    
    <div class="search-box">
        <input type="text" id="city-input" placeholder="Cari kota, kecamatan...">
        <button id="search-btn">Cari</button>
    </div>

    <div class="weather-card">
        <h2 class="location-main">Memuat...</h2>
        <p class="location-sub">-</p> 
        <div class="condition">
            <img class="condition-icon" src="" alt="Ikon cuaca">
            <p class="condition-text">-</p>
        </div>
        <h1 class="temperature">-&deg;C</h1>
        <div class="details">
            <div class="detail-item">
                <span class="label">Feels Like</span>
                <span class="value feels-like">-&deg;C</span>
            </div>
            <div class="detail-item">
                <span class="label">Humidity</span>
                <span class="value humidity">-%</span>
            </div>
            <div class="detail-item">
                <span class="label">Wind</span>
                <span class="value wind">- km/h</span>
            </div>
        </div>
    </div>

    <div id="sub-locations-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <script>
        // --- BARU: Fungsi untuk memilih VIDEO background berdasarkan cuaca ---
        function getBackgroundVideo(conditionText, isDay) {
            const condition = conditionText.toLowerCase();
            if (isDay) {
                if (condition.includes('sunny') || condition.includes('clear')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-sun-drenched-meadow-34442-large.mp4';
                } else if (condition.includes('cloudy') || condition.includes('overcast')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-clouds-and-blue-sky-2408-large.mp4';
                } else if (condition.includes('rain') || condition.includes('drizzle') || condition.includes('thundery')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-heavy-rain-on-a-window-2401-large.mp4';
                } else if (condition.includes('mist') || condition.includes('fog')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-countryside-road-in-the-fog-32765-large.mp4';
                } else {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-sun-drenched-meadow-34442-large.mp4'; // Default siang
                }
            } else { // Malam Hari
                if (condition.includes('clear')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-starry-night-sky-over-a-forest-813-large.mp4';
                } else if (condition.includes('cloudy') || condition.includes('overcast')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-time-lapse-of-a-sky-full-of-clouds-at-night-42250-large.mp4';
                } else if (condition.includes('rain') || condition.includes('drizzle')) {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-rain-falling-on-a-roof-at-night-48350-large.mp4';
                } else {
                    return 'https://assets.mixkit.co/videos/preview/mixkit-starry-night-sky-over-a-forest-813-large.mp4'; // Default malam
                }
            }
        }

        const apiKey = "5a690ce8dd4743fe8f811005250610"; // Ganti dengan API key Anda jika perlu

        // --- BARU: Fungsi untuk menampilkan cuaca kecamatan di bawah kartu utama ---
        function displaySubLocationWeather(city) {
            const subLocations = {
                'yogyakarta': ['Gondokusuman', 'Jetis', 'Tegalrejo', 'Danurejan', 'Gedongtengen', 'Ngampilan', 'Wirobrajan', 'Mantrijeron', 'Kraton', 'Gondomanan', 'Pakualaman', 'Mergangsan', 'Umbulharjo', 'Kotagede']
                // Anda bisa tambahkan kota lain di sini, contoh: 'jakarta': ['Gambir', 'Senen', ...]
            };
            
            const cityKey = city.toLowerCase();
            if (subLocations[cityKey]) {
                const container = $('#sub-locations-container');
                container.html('<h5>Cuaca di Kecamatan Lain:</h5>'); // Judul kecil

                subLocations[cityKey].forEach(kecamatan => {
                    const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${kecamatan}, ${city}&aqi=no`;
                    $.ajax({
                        url: url,
                        method: 'GET',
                        success: function(data) {
                            const temp = Math.round(data.current.temp_c);
                            const item = `<div class="sub-location-item">${kecamatan}<br><strong>${temp}°C</strong></div>`;
                            container.append(item);
                        },
                        error: function() {
                             const item = `<div class="sub-location-item">${kecamatan}<br><strong>-</strong></div>`;
                             container.append(item);
                        }
                    });
                });
            } else {
                $('#sub-locations-container').empty(); // Kosongkan jika kota tidak ada dalam daftar
            }
        }
        
        // --- Fungsi Utama untuk Mengambil Data Cuaca (Dimodifikasi) ---
        function getWeather(city) {
            const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${city}&aqi=no`;
            
            $('.location-main').text(`Mencari ${city}...`);
            $('.weather-card').removeClass('loaded');
            $('#sub-locations-container').empty(); // Kosongkan data kecamatan lama

            $.ajax({
                url: url,
                method: 'GET',
                success: function(data) {
                    const { location, current } = data;
                    $('.location-main').text(location.name);
                    // Menampilkan kombinasi region dan negara untuk kejelasan
                    $('.location-sub').text(`${location.region}, ${location.country}`); 
                    $('.temperature').text(Math.round(current.temp_c) + "°C");
                    $('.feels-like').text(Math.round(current.feelslike_c) + "°C");
                    $('.humidity').text(current.humidity + "%");
                    $('.wind').text(current.wind_kph + " km/h");
                    $('.condition-text').text(current.condition.text);
                    $('.condition-icon').attr('src', "https:" + current.condition.icon);
                    
                    // --- Mengatur Background Video Dinamis ---
                    const videoUrl = getBackgroundVideo(current.condition.text, current.is_day);
                    const videoElement = $('#bg-video');
                    // Ganti sumber video hanya jika berbeda untuk transisi yang mulus
                    if (videoElement.attr('src') !== videoUrl) {
                        videoElement.css('opacity', 0); // Fade out
                        setTimeout(() => {
                           videoElement.attr('src', videoUrl);
                           videoElement.get(0).load(); // Muat video baru
                           videoElement.css('opacity', 1); // Fade in
                        }, 1000); // Tunggu 1 detik sebelum ganti
                    }

                    $('.weather-card').addClass('loaded');
                    $('.condition, .temperature, .details').show();
                    
                    // --- BARU: Panggil fungsi untuk menampilkan kecamatan ---
                    displaySubLocationWeather(location.name);
                },
                error: function(error) {
                    $('.location-main').text("Lokasi tidak ditemukan");
                    $('.location-sub').text("Pastikan nama kota/kecamatan benar");
                    $('.condition, .temperature, .details').hide();
                    $('.weather-card').addClass('loaded');
                    console.log(error);
                }
            });
        }

        $('#search-btn').on('click', function() {
            let city = $('#city-input').val();
            if (city) getWeather(city);
        });

        $('#city-input').on('keypress', function(e) {
            if (e.which === 13) {
                let city = $('#city-input').val();
                if (city) getWeather(city);
            }
        });

        getWeather('Yogyakarta'); // Lokasi default saat pertama kali dibuka
    </script>
</body>
</html>